
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>ノーコードツールとLINEで在庫管理ミニアプリを作ろう！</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="line-"
                  title="ノーコードツールとLINEで在庫管理ミニアプリを作ろう！"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="ノーコードツールとLINEで在庫管理ミニアプリを作ろう！" duration="0">
        <p>・イベントページ</p>
<p><a href="https://linedevelopercommunity.connpass.com/event/218562/" target="_blank">https://linedevelopercommunity.connpass.com/event/218562/</a></p>
<p>・LINE Developer Community紹介！</p>
<p><a href="https://youtu.be/rtK_svx00s0" target="_blank">https://youtu.be/rtK_svx00s0</a></p>
<p>チャンネル登録をお願いしますー！</p>
<p class="image-container"><img style="width: 601.70px" src="img/aeffb1f3fff47b56.png"></p>
<p>・本日の資料</p>
<p><a href="https://mashandroom.github.io/line-gas-glide/" target="_blank">https://mashandroom.github.io/line-gas-glide/</a></p>


      </google-codelab-step>
    
      <google-codelab-step label="今日のイメージ" duration="0">
        <p class="image-container"><img style="width: 637.50px" src="img/199dfe5ab5f04690.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="登場人物は4人" duration="0">
        <ul>
<li>Messaging API</li>
<li>GAS(Google App Script) 、スプレッドシート </li>
<li>Glide</li>
<li>LIFF</li>
</ul>
<p>少し行ったり来たりしますが、資料をもとに一緒に進めていきましょう。</p>
<p>4.   LINE Developersへの登録</p>
<p>5.   今回のハンズオン用のスプレッドシートをコピー</p>
<p>6.   Glideの準備とアプリ公開</p>
<p>7.   LIFFの設定</p>
<p>8.   Messaging APIの設定</p>
<p>9.   GASの設定とデプロイ </p>
<p>10. Webhookの設定</p>
<p>11. 実際に動かしてみる！</p>


      </google-codelab-step>
    
      <google-codelab-step label="LINE Developers" duration="0">
        <aside class="special"><p>LINE Developersって？</p>
<p>LINEの各プロダクトを利用するための開発者向けのポータルサイトです。</p>
<p>ここではMessaging APIやLIFFを使うための準備をします。</p>
</aside>
<h2 is-upgraded>1.LINE Developers への登録</h2>
<p>LINE Developers（<a href="https://developers.line.biz/ja/" target="_blank">https://developers.line.biz/ja/</a>）からログインします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/faa17261b9332cfc.png"></p>
<h2 is-upgraded>2.アカウントを入力</h2>
<p>LINEアカウント・・・・・ 現在、利用しているLINEと連携することができます。</p>
<p>ビジネスアカウント・・・ メールアドレスで登録することができます。</p>
<p>※LINEアカウントだとスマホでQRコードを読み取ってログインができるなど簡単なのでお薦めです。（下図のような画面が表示されるので「QRコードログイン」を押します）</p>
<p class="image-container"><img style="width: 480.00px" src="img/85aa30fd459609a6.png"></p>
<p>アカウントをお持ちの方は、ログインしてチャネル作成に進みます。<br>アカウントをお持ちでないかたは、「3.アカウントの新規作成」に進みます。</p>
<h2 is-upgraded>3.アカウントの新規作成</h2>
<p>①初めての方は「アカウントの作成」を押下してください。</p>
<p class="image-container"><img style="width: 371.00px" src="img/bbd49bad6bf2a6d5.png"></p>
<p>②「LINEアカウントで登録」または「メールアドレスで登録」を選択してください。</p>
<p>LINEアカウントで登録のほうがQRコードログインでいけるので簡単です。個人のLINEアカウントと連携します。LINEアカウントで登録は簡単ですので、ここではメールアドレスで登録の説明をします。</p>
<p class="image-container"><img style="width: 436.00px" src="img/9e256a8a0c8d01e3.png"></p>
<p>③登録するメールアドレスを入力してください。</p>
<p class="image-container"><img style="width: 358.00px" src="img/42cd650bc6e93b7a.png"></p>
<p>④入力したメールアドレスに登録確認メールが届きますので「登録画面に進む」を押してください。</p>
<p class="image-container"><img style="width: 512.00px" src="img/985114d2d09ce79d.png"></p>
<p>⑤名前とパスワードを入力して登録してください。</p>
<p class="image-container"><img style="width: 333.00px" src="img/18bf618bab2767c9.png"></p>
<p>⑥登録確認画面で「登録」を押下</p>
<p class="image-container"><img style="width: 403.00px" src="img/a8b93cbe7e65624e.png"></p>
<p>⑦ユーザー登録が完了しました。LINE DevelopersIDの作成を行います</p>
<p class="image-container"><img style="width: 456.00px" src="img/dc6faf9b20e4c53d.png"></p>
<p>⑧LINE開発者登録</p>
<p>開発者名とメールアドレスを入力し、LINE開発者契約の内容を確認しチェックをいれ、アカウントを作成します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/2e836717c0b04fd1.png"></p>
<p>LINE Developersの画面が表示されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/b21cfe8b44849e09.png"></p>
<aside class="special"><p>これで準備完了です。</p>
<p>LINE Developersの画面は、この後何度か行ったり来たりしますので、別のタブなどに開きっぱなしにしておくと分かりやすいです。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="連携用のスプレッドシートをコピー" duration="0">
        <aside class="special"><p>ここでは、事前に用意されているハンズオン用のスプレッドシートを、各自のマイドライブにコピーします。</p>
</aside>
<p>下記をクリックするとスプレッドシートが開かれますので、「ファイル」-「コピーを作成」を押してください。</p>
<p><a href="https://docs.google.com/spreadsheets/d/1ZyRyULMww9Ti1VREi9z1q2-aCltCRDM26kVGUUq9F_Y/edit?usp=sharing" target="_blank">配布用：LINE DC 2021 在庫管理</a></p>
<p class="image-container"><img style="width: 464.00px" src="img/e51af5010776d1c2.png"></p>
<p>任意の名前をつけて「OK」を押します。</p>
<p class="image-container"><img style="width: 425.00px" src="img/81b212ea1549594b.png"></p>
<p class="image-container"><img style="width: 279.76px" src="img/c10769db193242e2.png"></p>
<p class="image-container"><img style="width: 565.50px" src="img/6967b926d45e9a3b.png"></p>
<aside class="special"><p>スプレッドシート が各自のマイドライブにコピーされます。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Glideの準備とアプリ公開" duration="0">
        <aside class="special"><p>Glideって？<br><a href="https://www.glideapps.com/" target="_blank">https://www.glideapps.com/</a></p>
<p>いわゆるノーコードツールと言われるものの1つです。</p>
<p>プログラムを記述することなく、アプリケーションを公開することができます。</p>
<p>スプレッドシートとも連携することができるため、ここではGlideでアプリを作成します。</p>
</aside>
<h2 is-upgraded>1.アカウント作成</h2>
<p><a href="https://www.glideapps.com/" target="_blank">https://www.glideapps.com/</a> にアクセスし、右上にある「Log in」を押します。</p>
<p class="image-container"><img style="width: 452.00px" src="img/3e29755be611342b.png"></p>
<p>アカウントをまだ持っていない場合は、「Sign in with Google」で先ほどコピーしたスプレッドシートと同じGoogleアカウントで連携します。</p>
<p class="image-container"><img style="width: 462.00px" src="img/2cc6844883d0f0e4.png"></p>
<p class="image-container"><img style="width: 498.00px" src="img/5ee82ca8b21337ea.png"></p>
<h2 is-upgraded>2.アクセス許可</h2>
<p>GlideからGoogleドライブ上のファイル（スプレッドシート）にアクセスするため、アクセスを許可する必要があります。</p>
<p class="image-container"><img style="width: 500.00px" src="img/9e68dff995a5f894.png"></p>
<h2 is-upgraded>3.新規アプリ作成</h2>
<p>Glideのダッシュボードが表示されます。「New App」を押しアプリを新規作成します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/80d98836afee63a9.png"></p>
<p>ここではアプリ名を「在庫管理」とし、「Continue」を押します。</p>
<p class="image-container"><img style="width: 478.00px" src="img/44523849f49ee6a9.png"></p>
<p>Glideアプリ内で使うデータの元をどこで管理するか？選択します。</p>
<p>スプレッドシートと連携するので「Google Sheets」を押します。</p>
<p class="image-container"><img style="width: 540.00px" src="img/a408c4c6bd8b4bbf.png"></p>
<p>Googleドライブ内のスプレッドシートが表示されますので、本ハンズオン用にコピーしたファイルを選択します。（下図では名称が異なりますが、先ほどコピーしたスプレッドシートを選択してください）</p>
<p class="image-container"><img style="width: 601.70px" src="img/fa168313c9d6b682.png"></p>
<p>以下の様に「在庫管理アプリ」の初期画面が表示されます。</p>
<p>スプレッドシートのデータがリスト形式で表示されているのが分かります。<br></p>
<p class="image-container"><img style="width: 601.70px" src="img/c66d6e2d879a4885.png"></p>
<p class="image-container"><img style="width: 262.00px" src="img/913c5531c045e44f.png"></p>
<aside class="special"><p>Glideでは、データの表示方法など見た目を比較的簡単に変更できますので、色々と触ってみても楽しいです。ここでは最初の表示のまま進めます。</p>
</aside>
<h2 is-upgraded>4.アプリ公開</h2>
<p>右上にある「Publish」ボタンを押すと、初めて公開する場合は下記画面が表示されますので「Publish App」を押します。</p>
<p class="image-container"><img style="width: 270.00px" src="img/7cd1fd77902cb24e.png"><br></p>
<p>APP LINKに任意の名前でアプリの名前（URL）を入力します。このアドレスがアプリのリンクとなり、後ほどLIFFのエンドポイントでもこのURLを指定します。</p>
<p class="image-container"><img style="width: 266.00px" src="img/9d7cbefd49f54dd2.png"></p>
<aside class="special"><p>APP LINKは、後ですぐに参照できるよう、Copyボタンを押してメモ帳などに貼り付けておくと便利です。</p>
<p>[メモ]</p>
<p>Glide APP LINK: https://任意の文字列.glideapp.io/</p>
</aside>
<aside class="special"><p>おまけ</p>
<p>上記は既に公開された状態になっていますので、URLをブラウザで表示すれば、実際に操作することができます。スマホなどでも操作できますので触ってみても楽しいです。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="LIFF" duration="0">
        <p>続いてLIFFの設定をしていきます。</p>
<aside class="special"><p>LIFFって？<br><a href="https://developers.line.biz/ja/docs/liff/overview/" target="_blank">https://developers.line.biz/ja/docs/liff/overview/</a><br></p>
<p>LIFFを使うと、LINEのトークルームの中だけで操作を完結できるため、ユーザーの操作性が格段に良くなります。</p>
<p>ここでは、Glideで公開したアプリをLINEのトークルームの中に表示するために使用します。</p>
</aside>
<h2 is-upgraded>1.プロバイダーの作成</h2>
<p>LINE Developersの画面を開き、プロバイダーの「作成」をします。プロバイダーが1つもない場合は、最初にプロバイダーを作成します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/6e334e50622888b8.png"></p>
<p>既にプロバイダーを利用しても問題ありません。</p>
<p class="image-container"><img style="width: 601.70px" src="img/f1b2995dca7b057c.png"></p>
<p>「プロバイダー名」は任意の名前で大丈夫です。</p>
<p class="image-container"><img style="width: 601.70px" src="img/d7dc789f45d8baa5.png"></p>
<p>プロバイダが作成されると、以下のような画面が表示されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/5ed2b4568bfdca16.png"></p>
<h2 is-upgraded>2.LINEログインチャネルの作成</h2>
<p>新規チャネル作成で「LINEログイン」を作成します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/50540f489be2997e.png"></p>
<p>以下の通り入力・設定し、「作成」を押します。</p>
<p class="image-container"><img style="width: 495.00px" src="img/8a4c3ec8f18d6741.png"></p>
<h2 is-upgraded>3.LIFFの設定</h2>
<p>チャネルが作成されると以下の画面が表示されます。</p>
<p>LIFFの設定をしていきましょう。</p>
<p>エンドポイントURLに、Glideアプリを公開した際のURLを設定します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/832c6af272d4483c.png"><br><br></p>
<p>「LIFF」タブを選択し、「追加」を押します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/513813c3096087d6.png"></p>
<p>LIFFアプリ追加画面が表示されるので、以下の通り入力していきます。</p>
<p>入力できたら「追加」を押します。</p>
<p class="image-container"><img style="width: 348.00px" src="img/8d1e4b1634af7276.png"></p>
<aside class="special"><p>Glideの公開URLは、「Glideの準備とアプリ公開」手順で作成した以下のようなURLです。</p>
<p>https://任意の文字列.glideapp.io/</p>
</aside>
<h2 is-upgraded>4.公開設定</h2>
<p>以上でLIFFアプリが作成されますが、非公開の状態のため公開に設定します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/43ac38c7a0bc4b83.png"></p>
<p>「非公開」を押すと下記画面が表示されるので「公開」します。</p>
<p>ステータスが「公開済み」に変更されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/90b8d722d54083a8.png"></p>
<p>以上でLIFFの準備ができました。</p>
<aside class="special"><p>LIFF URLはあとで使用しますのでどこかにコピーして残しておくか、このページに戻れるようにしておいてください。</p>
<p>[メモ]</p>
<p>Glide APP LINK: https://任意の文字列.glideapp.io/</p>
<p>LIFF URL: https://liff.line.me/xxxxxxxxxxx</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Messaging API" duration="0">
        <p>Messaging APIって？</p>
<p><a href="https://developers.line.biz/ja/docs/messaging-api/overview/" target="_blank">https://developers.line.biz/ja/docs/messaging-api/overview/</a></p>
<aside class="special"><p>Messaging APIを使うことで、LINE上でユーザーが送信したメッセージに基づいて、プログラムを動作させたり、プログラムからユーザーにメッセージを返信することができます。ここではメッセージの送信先がスプレッドシート （GAS）のプログラムになります。</p>
</aside>
<h2 is-upgraded>1.Messaging APIチャネルを作成</h2>
<p>LIFFの時と同様に、LINE Developerからチャネルを作成します。ここではチャネルの種類「Messaging API」にします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/5ed2b4568bfdca16.png"></p>
<p class="image-container"><img style="width: 601.70px" src="img/98afc124e29a1d07.png"></p>
<p>以下の通り入力をしていきましょう。</p>
<p class="image-container"><img style="width: 378.00px" src="img/6886c4678b8f7bce.png"></p>
<p class="image-container"><img style="width: 601.70px" src="img/c3f025880e833600.png"></p>
<p class="image-container"><img style="width: 601.70px" src="img/76aef7528704a7dd.png"></p>
<aside class="special"><p>チャネルが作成されると以下の「チャネル基本設定」の画面が表示されます。</p>
</aside>
<p class="image-container"><img style="width: 552.00px" src="img/81ff1f5703acff4b.png"></p>
<p>「Message APIの設定」タブから以下の赤枠の部分を編集していきます。</p>
<aside class="special"><p>「Webhook」の設定はスプレッドシート（GAS）をデプロイしてから行います。</p>
<p>ここでは「応答メッセージ」「チャネルアクセストークン」の設定をします。</p>
</aside>
<p class="image-container"><img style="width: 371.00px" src="img/8ec1c4beb83cee23.png"></p>
<h2 is-upgraded>2.応答メッセージの編集</h2>
<p>「応答メッセージ」の「編集」を押すと「LINE Official Account Manager」の画面が開きます。下記の通り「応答メッセージ」を「オフ」、「Webhook」を「オン」に変更します。</p>
<p class="image-container"><img style="width: 414.00px" src="img/7a3078776667f82a.png"></p>
<h2 is-upgraded>3.チャネルアクセストークン発行</h2>
<p>LINE Developersに戻り、チャネルアクセストークンを「発行」します。「発行」ボタンを押すと長い文字が表示されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/66c2226fe6cddf98.png"></p>
<aside class="special"><p>チャネルアクセストークンも次のGASデプロイで使用しますので、どこかにコピーしておくか、この画面に戻れるようにしておきましょう。</p>
<p>[メモ]</p>
<p>Glide APP LINK: https://任意の文字列.glideapp.io/</p>
<p>LIFF URL: https://liff.line.me/xxxxxxxxxxx</p>
<p>チャネルアクセストークン: すごく長い文字列</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="GAS（デプロイ ）" duration="0">
        <p>GASって？</p>
<p>Google Apps Scriptの略で、Googleが提供しているプログラミング言語です。GASを使うことで、Googleの色々なサービス（GmailやGoogleカレンダーなど）をプログラムでから操作することができます。</p>
<aside class="special"><p>ここではGASを使って、スプレッドシートのセルの値を読みとったり、セルの値を更新したりしています。それ以外にも、LINEで送信したメッセージをGASで受け取り、LINEにメッセージを応答するプログラムなどが書かれています。</p>
</aside>
<h2 is-upgraded>1.プログラムの修正</h2>
<p>コピーしたスプレッドシートを開き、GASのプログラムを編集していきます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/1e12bc496d32d539.png"></p>
<p>スクリプトエディタが起動します。</p>
<p>1回のクリックで起動しないことがあるので、その際は再度「スクリプトエディタ」をクリックしてください。</p>
<p class="image-container"><img style="width: 601.70px" src="img/4bfaaf56ae31558a.png"></p>
<p>左のメニューから「config.gs」があるのでクリックします。</p>
<p>編集する場所は以下3箇所です。&#34; &#34; は削除しないでください。&#34;と&#34;の間を書き換えます。</p>
<pre><code>const Config = {
 SpreadSheetUrl: &#34;https://docs.google.com/spreadsheets/d/xxxxxx/&#34;,
 LineChanleAccessToken: &#34;▲▲▲▲▲&#34;,
 LiffURL: &#34;■■■■■■■■■&#34;
}</code></pre>
<p>上から順番に、</p>
<p>・スプレッドシートのID</p>
<p>・チャネルアクセストークン</p>
<p>・LIFF URL</p>
<p>です。<br></p>
<p>・スプレッドシートID</p>
<p>スプレッドシートを開いているブラウザのURLの以下の <code>xxxxxx</code> 部分です。</p>
<p class="image-container"><img style="width: 601.70px" src="img/8bb1af5947654644.png"></p>
<aside class="special"><p>https://docs.google.com/spreadsheets/d/<code>xxxxxx</code>/edit#gid=0</p>
</aside>
<p>・チャネルアクセストークン</p>
<p>LINE Developerコンソールで発行した以下の長い文字列です。</p>
<p class="image-container"><img style="width: 601.70px" src="img/66c2226fe6cddf98.png"></p>
<p>・LIFF URL</p>
<p>LINEログインチャネルで作成した下記LIFF URLです。</p>
<p class="image-container"><img style="width: 601.70px" src="img/43ac38c7a0bc4b83.png"></p>
<p>変更したら必ず「保存」をしましょう。</p>
<p>変更が反映されていないと正常に動作しません。下記の様に保存されていない状態ではファイル名の横に●印がつきます。</p>
<p class="image-container"><img style="width: 298.00px" src="img/761bc9e960ed8bbb.png"></p>
<p>「保存」ボタンを押して保存すると●印が消えます。</p>
<p class="image-container"><img style="width: 223.00px" src="img/aae35b96aa6da6e3.png"></p>
<h2 is-upgraded>2.デプロイ</h2>
<p>保存したらデプロイをします。</p>
<p>デプロイとはアプリを公開することを言います。公開することで、LINEで送ったメッセージがGASで受け取れるようになります。</p>
<p>右上にある「デプロイ 」の▼を押し、「デプロイを管理」を押します。</p>
<p class="image-container"><img style="width: 288.00px" src="img/39c6786bf47ebe9e.png"></p>
<p>以下の画面が表示されるので、「デプロイメントの作成」を押します。<img style="width: 601.70px" src="img/24189785b6639f35.png"></p>
<p>以下の画面にて、下記の通り設定したら「デプロイ 」を押します。</p>
<p>説明：任意の説明文</p>
<p>次のユーザーとして実行：自分</p>
<p>アクセスできるユーザー：全員</p>
<p class="image-container"><img style="width: 601.70px" src="img/7d1bdcf959c58c75.png"></p>
<p>スプレッドシートにアクセスするために、アクセスの承認等を進めていきます。</p>
<p>資料に沿って進めていきましょう。</p>
<p class="image-container"><img style="width: 601.70px" src="img/b9cbee1862ced989.png"></p>
<p class="image-container"><img style="width: 494.00px" src="img/76e63714240e3598.png"></p>
<p class="image-container"><img style="width: 458.00px" src="img/7e16f644d0322291.png"></p>
<p class="image-container"><img style="width: 420.00px" src="img/5f7e9f55f89ce637.png"></p>
<p>最後に「許可」をすることでデプロイ が完了します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/4b335f40d3a76ed5.png"></p>
<p>デプロイ が完了したら、上記ウェブアプリ URLをLINE Messaging APIのWebhookに設定します。</p>
<aside class="special"><p>[メモ]</p>
<p>Glide APP LINK: https://任意の文字列.glideapp.io/</p>
<p>LIFF URL: https://liff.line.me/xxxxxxxxxxx</p>
<p>チャネルアクセストークン: すごく長い文字列</p>
<p>GAS ウェブアプリ URL: https://script.google.com/macros/s/xxxxxxxxxxxxxxxxx</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Webhook設定" duration="0">
        <p>デプロイしたウェブアプリURLをWebhook URLに設定し「更新」します。</p>
<p>下記、LINE Developersに戻ります。</p>
<p class="image-container"><img style="width: 371.00px" src="img/8ec1c4beb83cee23.png"></p>
<p>先ほど設定を飛ばした「Webhook設定」にて「編集」を押し、ウェブアプリURLを貼り付け「更新」を押します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/a56b4f171d532b39.png"></p>
<p>下記画面にて「Webhookの利用」が有効になっていることを確認し、「検証」を押します。設定が正しければ「成功」と表示されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/d47e76e8fa65a886.png"></p>
<p class="image-container"><img style="width: 601.70px" src="img/c7da9b8da42a5beb.png"></p>
<p>以下など、エラーが表示された場合は、Webhookに設定したURL（デプロイ したWebアプリURL）が正しいか？を再度確認してみてください。</p>
<p class="image-container"><img style="width: 601.70px" src="img/86e5778eba172ffd.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="実際に動かしてみよう！" duration="0">
        <p class="image-container"><img style="width: 200.00px" src="img/c0153f93cb4f8d4a.png"></p>
<p>LINE Developers Messaging API設定にQRコードがあります。</p>
<p>スマホで読み取ってボットを友達追加してみましょう。</p>
<p>在庫一覧や追加などを押して動かして見ましょう。</p>
<p>本日のイメージはこんな感じでした。</p>
<p class="image-container"><img style="width: 601.70px" src="img/199dfe5ab5f04690.png"></p>
<p>LINEから送ったメッセージ（操作）はGASというプログラム（スクリプト）を通じて、スプレッドシートが読み書きされます。「追加」や「発注」など操作した結果がスプレッドシートに記録されていきますので、合わせて見てみましょう。</p>
<p class="image-container"><img style="width: 341.50px" src="img/885860843bf37c23.png"></p>
<ul>
<li>在庫一覧<br>スプレッドシートのstockシートで管理されている商品と在庫数を表示します。<br>stockシート記載の商品のみ操作できますので、増やしてみたい商品があればstockシートに商品名と在庫数を追加して試してみてください。</li>
<li>追加<br>在庫を追加する商品名と数を送信すると、スプレッドシートの当該商品の在庫数が増えます。</li>
<li>引出<br>在庫から引出する商品名と数を送信すると、スプレッドシートの当該商品の在庫数が減ります。<br></li>
<li>発注<br>発注する商品名と数を送信するとorderシートに記録されます。<br>ここでは記録するのみですが、Gmaiと連携して業者に発注メールを送るなどもできそうですね。</li>
<li>LIFF<br>Glideアプリがトークルーム内に表示されます。<br>LIFFやGlideの設定が正常に行われていると「LIFF」を押すとLINE内にGlideアプリが起動します。</li>
</ul>
<p><img style="width: 346.38px" src="img/e26334d9e963aeac.png"><br> stock：在庫一覧<br> order：発注の記録<br> log：追加と引出の記録</p>
<p class="image-container"><img style="width: 305.00px" src="img/bb1148991dbdae60.png"></p>
<aside class="special"><p>LINE bot での在庫操作の結果は一度スプレッドシートに反映されますが、スプレッドシートの更新がすぐにGlideアプリ上に反映されないことがあります。</p>
<p>しばらくするとGlideアプリ上でも変更されているのがわかると思います。</p>
</aside>
<aside class="special"><p>もし途中で動かなくなった場合は、右上の三本線の部分をタップし、一度botをブロック=&gt;ブロック解除すると、再度最初から動作できますのでお試しください。</p>
</aside>
<p class="image-container"><img style="width: 305.00px" src="img/af4c8e50cd79d0b1.png"></p>
<p class="image-container"><img style="width: 304.00px" src="img/ddff68addb847828.png"></p>
<p class="image-container"><img style="width: 305.00px" src="img/dc949f0ec29608d1.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="いかがでしたでしょうか？" duration="0">
        <p>ご質問等、お気軽にご連絡ください。</p>
<p><a href="mailto:kinoko@mashandroom.org" target="_blank">kinoko@mashandroom.org</a></p>
<p><a href="https://www.facebook.com/happy.happy.children/" target="_blank">https://www.facebook.com/happy.happy.children/</a></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
